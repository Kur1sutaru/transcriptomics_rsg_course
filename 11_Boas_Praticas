# üß¨ An√°lise de RNA-seq com DESeq2 no Galaxy

## üìö Sum√°rio <!-- TOC -->
- [üìå Objetivo](#-objetivo)
- [‚ö†Ô∏è Principais Armadilhas e Como Resolver](#Ô∏è-principais-armadilhas-e-como-resolver)
  - [1. Problemas de Converg√™ncia](#1-problemas-de-converg√™ncia)
  - [2. Outliers Fortes](#2-outliers-fortes)
  - [3. Dados Faltantes ou Mal Formatados](#3-dados-faltantes-ou-mal-formatados)
  - [4. Normaliza√ß√£o Inadequada](#4-normaliza√ß√£o-inadequada)
  - [5. Modelo Experimental Incorreto](#5-modelo-experimental-incorreto)
- [üõ†Ô∏è Ferramentas no Galaxy Recomendadas](#Ô∏è-ferramentas-no-galaxy-recomendadas)
- [‚úÖ Exemplo Pr√°tico](#-exemplo-pr√°tico)
- [üìö Refer√™ncias](#-refer√™ncias)

---

## üìå Objetivo
Realizar an√°lise de express√£o diferencial usando **DESeq2** no **Galaxy**, evitando erros comuns como:
- Falha de converg√™ncia
- Outliers extremos
- Dados faltantes ou mal formatados
- Normaliza√ß√£o inadequada
- Modelo experimental incorreto

---

## ‚ö†Ô∏è Principais Armadilhas e Como Resolver

### 1. Problemas de Converg√™ncia
**Sintoma:** Mensagens de erro como `iteration limit reached`.

**Diagn√≥stico:**
- DESeq2 falha ou retorna log2FoldChange como `NA`.

**Solu√ß√µes:**
- Aplique filtro de baixa express√£o antes de rodar DESeq2.
- Ative `independent filtering = TRUE` no Galaxy.
- Verifique se h√° replicatas biol√≥gicas suficientes (m√≠nimo 3 por grupo).

---

### 2. Outliers Fortes
**Sintoma:** Genes com valores extremos e estat√≠sticas incoerentes.

**Diagn√≥stico:**
- Gere gr√°ficos de Cook‚Äôs Distance no Galaxy.
- Execute PCA para visualizar agrupamentos.

**Solu√ß√µes:**
- Use a op√ß√£o `cooksCutoff = TRUE`.
- Remova amostras discrepantes se necess√°rio.

---

### 3. Dados Faltantes ou Mal Formatados
**Sintoma:** Arquivo de contagens falha na importa√ß√£o ou DESeq2 n√£o reconhece colunas.

**Diagn√≥stico:**
- Inspecione os arquivos com `Inspect`, `Sort`, `Remove columns with NA`.

**Solu√ß√µes:**
- Verifique:
  - Se h√° cabe√ßalho com nomes de amostras.
  - Se todos os campos est√£o preenchidos.
- Corrija via ferramentas de manipula√ß√£o de tabela do Galaxy.

---

### 4. Normaliza√ß√£o Inadequada
**Sintoma:** Dispers√£o alta, boxplots desbalanceados entre amostras.

**Diagn√≥stico:**
- Gere boxplots e PCA ap√≥s normaliza√ß√£o com `rlog` ou `vst`.

**Solu√ß√µes:**
- Use **normaliza√ß√£o por fator de tamanho**.
- Gere contagens normalizadas para visualiza√ß√£o.

---

### 5. Modelo Experimental Incorreto
**Sintoma:** Compara√ß√µes erradas ou sem significado biol√≥gico.

**Diagn√≥stico:**
- Verifique o `Design Formula` (ex: ~ condition).
- Analise a planilha de metadados.

**Solu√ß√µes:**
- A coluna usada como fator (ex: `condition`) deve ter apenas texto categ√≥rico (ex: `tratado`, `controle`).
- N√£o use espa√ßos ou acentos nos nomes de colunas ou categorias.

---

## üõ†Ô∏è Ferramentas no Galaxy Recomendadas

| Etapa | Ferramenta | Finalidade |
|-------|------------|------------|
| Pr√©-processamento | `FeatureCounts`, `Filter table by expression level` | Contagens e filtro |
| An√°lise Principal | `DESeq2`, `DESeq2 (Multifactor)` | Express√£o diferencial |
| Diagn√≥stico | `Cook's distance`, `PCA plot`, `MA-plot`, `rlog`, `vst` | QC e valida√ß√£o |
| Visualiza√ß√£o | `Heatmap`, `Boxplot`, `Volcano Plot` | Interpreta√ß√£o |
| Manipula√ß√£o | `Cut`, `Join`, `Group`, `Remove columns with missing values` | Ajuste de tabelas |

---

## ‚úÖ Exemplo Pr√°tico

```bash
1. Carregue o arquivo de contagens com genes nas linhas e amostras nas colunas.
2. Importe a tabela de metadados (TSV) com as colunas: sample_id, condition.
3. Rode DESeq2 no Galaxy:
   - Counts file: <seu arquivo>
   - Metadata file: <arquivo de metadados>
   - Design formula: ~ condition
4. Habilite:
   - Output normalized counts
   - Output Cook's distance
   - independentFiltering = TRUE
5. Gere:
   - PCA plot
   - MA plot
   - Heatmap
6. Filtre genes com padj < 0.05 e |log2FC| > 1


:book: Refer√™ncias
Galaxy DESeq2 Tool Help

Love et al. (2014) DESeq2 paper

Bioconductor DESeq2 vignette
